<div class="min-h-screen bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 flex flex-col items-center p-4">
    <h1 class="text-2xl font-bold mb-6 dark:text-white">Reporte de Estado de Tumbas</h1>

    <!-- Formulario de Filtros -->
    <div class="w-full max-w-4xl bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 mb-6">
        <form [formGroup]="searchForm" (ngSubmit)="onSearch()" class="space-y-4">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div>
                    <label for="nameLote" class="block text-sm font-medium mb-2 dark:text-gray-200">Número de
                        Bloque</label>
                    <input id="nameLote" formControlName="nameLote" type="text" placeholder="Número de Bloque"
                        class="w-full px-4 py-2 border rounded dark:bg-gray-700 dark:text-gray-100" />
                </div>
                <div>
                    <label for="nicheType" class="block text-sm font-medium mb-2 dark:text-gray-200">Tipo de
                        Tumba</label>
                    <select id="nicheType" formControlName="nicheType"
                        class="w-full px-4 py-2 border rounded dark:bg-gray-700 dark:text-gray-100">
                        <option value="">Todos</option>
                        <option value="T">Tumba en Tierra</option>
                        <option value="E">Tumba Extramuros</option>
                    </select>
                </div>
                <div>
                    <label for="available"
                        class="block text-sm font-medium mb-2 dark:text-gray-200">Disponibilidad</label>
                    <select id="available" formControlName="available"
                        class="w-full px-4 py-2 border rounded dark:bg-gray-700 dark:text-gray-100">
                        <option value="">Todos</option>
                        <option value="true">Disponible</option>
                        <option value="false">Ocupado</option>
                    </select>
                </div>
            </div>
            <div class="flex justify-end space-x-4">
                <button type="button" (click)="resetFilters()"
                    class="bg-gray-500 text-white px-4 py-2 rounded-lg shadow-sm hover:bg-gray-600 dark:bg-gray-700 dark:hover:bg-gray-600">
                    Reset
                </button>
                <button type="submit"
                    class="bg-blue-600 text-white px-4 py-2 rounded-lg shadow-sm hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600">
                    Buscar
                </button>
            </div>
        </form>
    </div>
    <!-- Gráfico de Estado de Tumbas -->
    <div class="container mx-auto p-4 bg-white dark:bg-gray-800 rounded shadow-lg mb-6">
        <apx-chart *ngIf="chartOptions" [series]="chartOptions.series" [chart]="chartOptions.chart"
            [xaxis]="chartOptions.xaxis" [yaxis]="chartOptions.yaxis" [dataLabels]="chartOptions.dataLabels"
            [plotOptions]="chartOptions.plotOptions">
        </apx-chart>
    </div>
    <!-- Tabla de datos de ocupación -->
    <div class="overflow-x-auto w-full max-w-4xl mb-6 bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
        <table class="min-w-full bg-white dark:bg-gray-800 rounded-lg shadow-md">
            <thead>
                <tr>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 dark:text-gray-200 uppercase">
                        Número de Tumba</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 dark:text-gray-200 uppercase">Tipo
                        de Tumba</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 dark:text-gray-200 uppercase">
                        Disponibilidad</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 dark:text-gray-200 uppercase">
                        Difunto</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 dark:text-gray-200 uppercase">
                        Ceremonia</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 dark:text-gray-200 uppercase">
                        Fecha</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let tumba of tumbaEstadoList" class="border-b border-gray-200 dark:border-gray-700">
                    <td class="px-6 py-4 text-sm text-gray-900 dark:text-gray-100">{{ tumba.nicheNumber }}</td>
                    <td class="px-6 py-4 text-sm text-gray-900 dark:text-gray-100">{{ tumba.nicheType }}</td>
                    <td class="px-6 py-4 text-sm text-gray-900 dark:text-gray-100">{{ tumba.available ? 'Disponible' :
                        'Ocupado' }}</td>
                    <td class="px-6 py-4 text-sm text-gray-900 dark:text-gray-100">{{ tumba.difunto ?
                        (tumba.difunto.names + ' ' + tumba.difunto.last_names) : 'N/A' }}</td>
                    <td class="px-6 py-4 text-sm text-gray-900 dark:text-gray-100">
                        <span *ngFor="let servicio of tumba.servicio">
                            {{ servicio.ceremony }}</span>
                    </td>
                    <td class="px-6 py-4 text-sm text-gray-900 dark:text-gray-100"><span
                            *ngFor="let servicio of tumba.servicio">
                            {{ servicio.startDate | date: 'short' }}</span></td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Paginación Condicional -->
    <div *ngIf="isPaginated" class="flex justify-center mt-4 space-x-2">
        <button (click)="onPageChange(currentPage - 1)" [disabled]="currentPage === 1"
            class="px-4 py-2 bg-blue-500 text-white rounded">Anterior</button>
        <span class="text-gray-700 dark:text-gray-300">Página {{ currentPage }} de {{ totalPages }}</span>
        <button (click)="onPageChange(currentPage + 1)" [disabled]="currentPage === totalPages"
            class="px-4 py-2 bg-blue-500 text-white rounded">Siguiente</button>
    </div>
</div>